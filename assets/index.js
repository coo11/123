!function(){"use strict";function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function e(t,e,n,r,i,o,s){try{var c=t[o](s),a=c.value}catch(t){return void n(t)}c.done?e(a):Promise.resolve(a).then(r,i)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e,n){return e&&function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,l(r.key),r)}}(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function i(t,e,n){return(e=l(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach(function(e){i(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function c(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */
var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var c=r&&r.prototype instanceof u?r:u,l=Object.create(c.prototype);return a(l,"_invoke",function(n,r,i){var o,c,a,u=0,l=i||[],p=!1,f={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return o=e,c=0,a=t,f.n=n,s}};function h(n,r){for(c=n,a=r,e=0;!p&&u&&!i&&e<l.length;e++){var i,o=l[e],h=f.p,d=o[2];n>3?(i=d===r)&&(a=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=t):o[0]<=h&&((i=n<2&&h<o[1])?(c=0,f.v=r,f.n=o[1]):h<d&&(i=n<3||o[0]>r||r>d)&&(o[4]=n,o[5]=r,f.n=d,c=0))}if(i||n>1)return s;throw p=!0,r}return function(i,l,d){if(u>1)throw TypeError("Generator is already running");for(p&&1===l&&h(l,d),c=l,a=d;(e=c<2?t:a)||!p;){o||(c?c<3?(c>1&&(f.n=-1),h(c,a)):f.n=a:f.v=a);try{if(u=2,o){if(c||(i="next"),e=o[i]){if(!(e=e.call(o,a)))throw TypeError("iterator result is not an object");if(!e.done)return e;a=e.value,c<2&&(c=0)}else 1===c&&(e=o.return)&&e.call(o),c<2&&(a=TypeError("The iterator does not provide a '"+i+"' method"),c=1);o=t}else if((e=(p=f.n<0)?a:n.call(r,f))!==s)break}catch(e){o=t,c=1,a=e}finally{u=1}}return{value:e,done:p}}}(n,i,o),!0),l}var s={};function u(){}function l(){}function p(){}e=Object.getPrototypeOf;var f=[][r]?e(e([][r]())):(a(e={},r,function(){return this}),e),h=p.prototype=u.prototype=Object.create(f);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,a(t,i,"GeneratorFunction")),t.prototype=Object.create(h),t}return l.prototype=p,a(h,"constructor",p),a(p,"constructor",l),l.displayName="GeneratorFunction",a(p,i,"GeneratorFunction"),a(h),a(h,i,"Generator"),a(h,r,function(){return this}),a(h,"toString",function(){return"[object Generator]"}),(c=function(){return{w:o,m:d}})()}function a(t,e,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}a=function(t,e,n,r){function o(e,n){a(t,e,function(t){return this._invoke(e,n,t)})}e?i?i(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(o("next",0),o("throw",1),o("return",2))},a(t,e,n,r)}function u(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||f(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function f(e,n){if(e){if("string"==typeof e)return t(e,n);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}var h=function(t){return"string"==typeof t?document.querySelector(t):t()},d=function(t,e){var n="string"==typeof t?document.createElement(t):t;for(var r in e){var i=e[r];if("inside"===r)i.append(n);else if("dest"===r)h(i[0]).insertAdjacentElement(i[1],n);else if("around"===r){var o=i;o.parentNode.insertBefore(n,o),n.append(o),null!=o.getAttribute("autofocus")&&o.focus()}else r in n?n[r]=i:n.setAttribute(r,i)}return n},m=function(t,e){return t=String(t).toLowerCase(),e?t.normalize("NFD").replace(/[\u0300-\u036f]/g,"").normalize("NFC"):t},v=function(t,e){return d("mark",s({innerHTML:t},"string"==typeof e&&{class:e})).outerHTML},g=function(t,e){e.input.dispatchEvent(new CustomEvent(t,{bubbles:!0,detail:e.feedback,cancelable:!0}))},b=function(t,e,n){var r=n||{},i=r.mode,o=r.diacritics,s=r.highlight,c=m(e,o);if(e=String(e),t=m(t,o),"loose"===i){var a=(t=t.replace(/ /g,"")).length,u=0,l=Array.from(e).map(function(e,n){return u<a&&c[n]===t[u]&&(e=s?v(e,s):e,u++),e}).join("");if(u===a)return l}else{var p=c.indexOf(t);if(~p)return t=e.substring(p,p+t.length),p=s?e.replace(t,v(t,s)):e}},y=function(t,e){return new Promise(function(n,r){var i;return(i=t.data).cache&&i.store?n():new Promise(function(t,n){return"function"==typeof i.src?new Promise(function(t,n){return"AsyncFunction"===i.src.constructor.name?i.src(e).then(t,n):t(i.src(e))}).then(t,n):t(i.src)}).then(function(e){try{return t.feedback=i.store=e,g("response",t),n()}catch(t){return r(t)}},r)})},w=function(t,e){var n=e.data,r=e.searchEngine,i=[];n.store.forEach(function(o,s){var c=function(n){var s=n?o[n]:o,c="function"==typeof r?r(t,s):b(t,s,{mode:r,diacritics:e.diacritics,highlight:e.resultItem.highlight});if(c){var a={match:c,value:o};n&&(a.key=n),i.push(a)}};if(n.keys){var a,u=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=f(t))||e){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw o}}}}(n.keys);try{for(u.s();!(a=u.n()).done;){c(a.value)}}catch(t){u.e(t)}finally{u.f()}}else c()}),n.filter&&(i=n.filter(i));var o=i.slice(0,e.resultsList.maxResults);e.feedback={query:t,matches:i,results:o},g("results",e)},x="aria-expanded",k="aria-activedescendant",L="aria-selected",E=function(t,e){t.feedback.selection=s({index:e},t.feedback.results[e])},S=function(t){t.isOpen||((t.wrapper||t.input).setAttribute(x,!0),t.list.removeAttribute("hidden"),t.isOpen=!0,g("open",t))},O=function(t){t.isOpen&&((t.wrapper||t.input).setAttribute(x,!1),t.input.setAttribute(k,""),t.list.setAttribute("hidden",""),t.isOpen=!1,g("close",t))},T=function(t,e){var n=e.resultItem,r=e.list.getElementsByTagName(n.tag),i=!!n.selected&&n.selected.split(" ");if(e.isOpen&&r.length){var o,s,c=e.cursor;if(t>=r.length&&(t=0),t<0&&(t=r.length-1),e.cursor=t,c>-1)r[c].removeAttribute(L),i&&(s=r[c].classList).remove.apply(s,u(i));r[t].setAttribute(L,!0),i&&(o=r[t].classList).add.apply(o,u(i)),e.input.setAttribute(k,r[e.cursor].id),e.list.scrollTop=r[t].offsetTop-e.list.clientHeight+r[t].clientHeight+5,e.feedback.cursor=e.cursor,E(e,t),g("navigate",e)}},j=function(t){T(t.cursor+1,t)},A=function(t){T(t.cursor-1,t)},I=function(t,e,n){(n=n>=0?n:t.cursor)<0||(t.feedback.event=e,E(t,n),g("selection",t),O(t))};function P(t,e){var n=this;return new Promise(function(r,i){var o,c;return o=e||((c=t.input)instanceof HTMLInputElement||c instanceof HTMLTextAreaElement?c.value:c.innerHTML),function(t,e,n){return e?e(t):t.length>=n}(o=t.query?t.query(o):o,t.trigger,t.threshold)?y(t,o).then(function(e){try{return t.feedback instanceof Error||t.cancelIfInputNothing&&!t.input.value?r():(w(o,t),t.resultsList&&function(t){var e=t.resultsList,n=t.list,r=t.resultItem,i=t.feedback,o=i.matches,c=i.results;if(t.cursor=-1,n.innerHTML="",o.length||e.noResults){var a=new DocumentFragment,l=!!r.selected&&r.selected.split(" ");c.forEach(function(e,n){var i=d(r.tag,s({id:"".concat(r.id,"_").concat(n),role:"option",innerHTML:e.match,inside:a},r.class&&{class:r.class}));i.addEventListener("touchstart",function(){var t;return l&&(t=i.classList).add.apply(t,u(l))}),i.addEventListener("touchend",function(){var t;return l&&(t=i.classList).remove.apply(t,u(l))}),i.addEventListener("mouseenter",function(e){if(e.timeStamp-t.allowMouseEventAfter>500){var r,o,s=t.cursor;t.cursor=n,l&&((r=i.classList).add.apply(r,u(l)),s>-1&&n!=s&&(o=i.parentElement.children[s].classList).remove.apply(o,u(l)))}}),i.addEventListener("mouseleave",function(e){if(e.timeStamp-t.allowMouseEventAfter>500){var n,o=e.relatedTarget;o&&!o.id.startsWith(r.id)&&(t.cursor=-1,l&&(n=i.classList).remove.apply(n,u(l)))}}),r.element&&r.element(i,e)}),n.append(a),e.element&&e.element(n,i),S(t)}else O(t)}(t),a.call(n))}catch(t){return i(t)}},i):(O(t),a.call(n));function a(){return r()}})}var q=function(t,e){for(var n in t)for(var r in t[n])e(n,r)},D=function(t){var e,n,r,i=t.events,o=(e=function(){return P(t)},n=t.debounce,function(){clearTimeout(r),r=setTimeout(function(){return e()},n)}),c=t.events=s({input:s({},i&&i.input)},t.resultsList&&{list:i?s({},i.list):{}}),a={input:{compositionstart:function(){t.input.composing=!0},compositionend:function(){t.input.composing&&(t.input.composing=!1,t.eventTrigger(t.input,"input"))},change:function(){t.input.composing&&(t.input.composing=!1,t.eventTrigger(t.input,"input"))},input:function(){!t.input.composing&&o()},keydown:function(e){!function(t,e){switch(t.keyCode){case 40:case 38:t.preventDefault(),e.allowMouseEventAfter=t.timeStamp,40===t.keyCode?j(e):A(e);break;case 13:e.submit||t.preventDefault(),e.cursor>=0&&I(e,t);break;case 9:e.resultsList.tabSelect&&e.cursor>=0&&I(e,t);break;case 27:e.input.value="",O(e)}}(e,t)},blur:function(){O(t)}},list:{mousedown:function(t){t.preventDefault()},click:function(e){!function(t,e){var n=e.resultItem.tag.toUpperCase(),r=Array.from(e.list.querySelectorAll(n)),i=t.target.closest(n);i&&i.nodeName===n&&(/android/gi.test(window.navigator.userAgent)&&(e.input.blur(),e.input.focus()),I(e,t,r.indexOf(i)))}(e,t)}}};q(a,function(e,n){(t.resultsList||"input"===n)&&(c[e][n]||(c[e][n]=a[e][n]))}),q(c,function(e,n){t[e].addEventListener(n,c[e][n])})};function C(t){var e=this;return new Promise(function(n,r){var i,o,c;if(i=t.placeHolder,c={role:"combobox","aria-owns":(o=t.resultsList).id,"aria-haspopup":!0,"aria-expanded":!1},d(t.input,s(s({"aria-controls":o.id,"aria-autocomplete":"both"},i&&{placeholder:i}),!t.wrapper&&s({},c))),t.wrapper&&(t.wrapper=d("div",s({around:t.input,class:t.name+"_wrapper"},c))),o&&(t.list=d(o.tag,s({dest:[o.destination,o.position],id:o.id,role:"listbox",hidden:"hidden"},o.class&&{class:o.class}))),D(t),t.data.cache)return y(t).then(function(t){try{return a.call(e)}catch(t){return r(t)}},r);function a(){return g("init",t),n()}return a.call(e)})}function _(t){var e=t.prototype;e.init=function(){C(this)},e.start=function(t){P(this,t)},e.unInit=function(){if(this.wrapper){var t=this.wrapper.parentNode;t.insertBefore(this.input,this.wrapper),t.removeChild(this.wrapper)}var e;q((e=this).events,function(t,n){e[t].removeEventListener(n,e.events[t][n])})},e.open=function(){S(this)},e.close=function(){O(this)},e.goTo=function(t){T(t,this)},e.next=function(){j(this)},e.previous=function(){A(this)},e.select=function(t){I(this,null,t)},e.search=function(t,e,n){return b(t,e,n)}}function M(t){this.options=t,this.id=M.instances=(M.instances||0)+1,this.name="autoComplete",this.wrapper=1,this.threshold=1,this.debounce=0,this.resultsList={position:"afterend",tag:"ul",maxResults:5},this.resultItem={tag:"li"},this.allowMouseEventAfter=0,this.cancelIfInputNothing=!1,this.eventTrigger=function(t,e){var n=document.createEvent("HTMLEvents");n.initEvent(e,!0,!0),t.dispatchEvent(n)},function(t){var e=t.name,n=t.options,r=t.resultsList,i=t.resultItem;for(var o in n)if("object"===p(n[o]))for(var s in t[o]||(t[o]={}),n[o])t[o][s]=n[o][s];else t[o]=n[o];t.selector=t.selector||"#"+e,r.destination=r.destination||t.selector,r.id=r.id||e+"_list_"+t.id,i.id=i.id||e+"_result",t.input=h(t.selector)}(this),_.call(this,M),C(this)}var H=function(t){return new Promise(function(e){var n=document.createElement("script"),r="_jsonp_".concat((new Date).getTime());n.src=t+r,window[r]=function(t){e(new Response(JSON.stringify(t))),n.remove(),delete window[r]},document.body.appendChild(n)})};window.rememberLastUse=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];localStorage.setItem("rememberLastUse",Number(t))};var N={list:[{name:"Google",shortcut:"#g",icon:"google.svg",autoComplete:!0,prefix:"https://www.google.com/search?q=",sug:"https://suggestqueries.google.com/complete/search?client=chrome&q={keyword}&callback="},{name:"百度",shortcut:"#bd",icon:"baidu.svg",autoComplete:!0,prefix:"https://www.baidu.com/s?wd=",sug:"https://www.baidu.com/su?p=3&wd={keyword}&cb="},{name:"Bing",shortcut:"#bi",icon:"bing.svg",autoComplete:!0,prefix:"https://www.bing.com/search?q=",sug:"https://api.bing.com/qsonhs.aspx?type=cb&q={keyword}&cb="},{name:"搜狗",shortcut:"#sg",icon:"sogou.svg",autoComplete:!0,prefix:"https://www.sogou.com/web?query=",sug:"https://wap.sogou.com/web/sugg/{keyword}?vr=1&s=1&source=wapsearch&encrypt=0&cb="},{name:"DuckDuckGo",shortcut:"#ddg",icon:"duckduckgo.svg",autoComplete:!1,prefix:"https://duckduckgo.com/?q="},{name:"微博",shortcut:"#wb",icon:"weibo.svg",prefix:"https://s.weibo.com/weibo?q="},{name:"Twitter",shortcut:"#t",icon:"twitter.svg",prefix:"https://x.com/search?q="},{name:"Bilibili",shortcut:"#bl",icon:"bilibili.svg",prefix:"https://search.bilibili.com/all?keyword="},{name:"Youtube",shortcut:"#y",icon:"youtube.svg",prefix:"https://www.youtube.com/results?search_query="},{name:"Github",shortcut:"#gh",icon:"github.svg",prefix:"https://github.com/search?q="},{name:"Github Gist",shortcut:"#gg",icon:"github.svg",prefix:"https://gist.github.com/search?q="},{name:"StackOverflow",shortcut:"#so",icon:"stackoverflow.svg",prefix:"https://stackoverflow.com/search?q="},{name:"Reddit",shortcut:"#rd",icon:"reddit.svg",prefix:"https://www.reddit.com/search?q="},{name:"知乎",shortcut:"#zh",icon:"zhihu.svg",prefix:"https://www.zhihu.com/search?q="},{name:"Danbooru",shortcut:"#db",icon:"danbooru.svg",autoComplete:!1,prefix:"https://danbooru.donmai.us/posts?tags="},{name:"淘宝",shortcut:"#tb",icon:"taobao.svg",prefix:"https://s.taobao.com/search?q="},{name:"京东",shortcut:"#jd",icon:"jd.svg",prefix:"https://search.jd.com/Search?keyword="},{name:"AppleMusic",shortcut:"#am",icon:"applemusic.svg",prefix:"https://music.apple.com/jp/search?term="},{name:"天使动漫",shortcut:"#tsdm",icon:"tsdm.svg",prefix:"https://www.tsdm39.com/plugin.php?id=Kahrpba:search&authorid=0&fid=0&query="},{name:"SoulPlus",shortcut:"#hj",icon:"soulplus.svg",prefix:"https://bbs.imoutolove.me/search.php?step=2&method=AND&sch_area=0&f_fid=all&sch_time=all&orderway=postdate&asc=DESC&keyword="}],rememberLastUse:Number(localStorage.getItem("rememberLastUse")),get currentEngine(){if(this._engine)return this._engine;var t,e=localStorage.getItem("lastUse");return this.rememberLastUse&&e&&(null===(t=this.list.filter(function(t){return"lastUsed"===t.shortcut}))||void 0===t?void 0:t[0])||this.list[0]},set currentEngine(t){localStorage.setItem("lastUse",t.shortcut),this._engine=t},init:function(){var t=this.currentEngine.icon;this.switchIcon(t)},switchIcon:function(t){document.querySelector("svg.M > use").setAttribute("xlink:href","assets/sprite.svg#"+t.slice(0,-4))},dash:function(t){var e=this.currentEngine.prefix;window.open(e+encodeURIComponent(t),"_blank")},itemContent:function(t){var e=t.icon,n=t.name,r=t.shortcut,i=e.slice(0,-4);return'<div class="ba">'+'<svg class="ca"><use xlink:href="assets/sprite.svg#'.concat(i,'"></use></svg>')+'<span class="da">'.concat(n,"</span>")+'</div><div class="ea">'.concat(r,"</div>")}};N.init();var R=new M({wrapper:!1,selector:"input.P",data:{src:N.list,keys:["shortcut"]},resultsList:{class:"V W",destination:"form.K",maxResults:100},resultItem:{class:"aa",element:function(t,e){t.innerHTML=N.itemContent(e.value)},selected:"ha"}}),U=new M({wrapper:!1,selector:"input.Q",searchEngine:function(t,e){return e},cancelIfInputNothing:!0,data:{src:(z=c().m(function t(e){var n,r,i,o,s,a,u,l,p,f,h;return c().w(function(t){for(;;)switch(t.n){case 0:if(!e.startsWith("#")){t.n=1;break}return e=e.replace(/^#/,"").replace(/\s/g,""),r=[],(i=N.list.filter(function(t){return t.shortcut.indexOf(e)>-1||(r.push(t),!1)})).sort(),t.a(2,i.concat.apply(i,r));case 1:if(s=N.currentEngine,a=s.autoComplete,u=s.sug,l=s.shortcut,!a){t.n=8;break}return p=u.replace("{keyword}",encodeURIComponent(e)),t.n=2,H(p);case 2:return t.n=3,t.v.json();case 3:f=t.v,h=l,t.n="#g"===h?4:"#bd"===h?5:"#bi"===h?6:"#sg"===h?7:8;break;case 4:return o=f[1],t.a(3,8);case 5:return o=f.s,t.a(3,8);case 6:return o=null===(n=f.AS.Results)||void 0===n?void 0:n[0].Suggests.map(function(t){return t.Txt}),t.a(3,8);case 7:return o=f.s.map(function(t){return t.q}),t.a(3,8);case 8:return t.a(2,o||[]);case 9:return t.a(2)}},t)}),K=function(){var t=this,n=arguments;return new Promise(function(r,i){var o=z.apply(t,n);function s(t){e(o,r,i,s,c,"next",t)}function c(t){e(o,r,i,s,c,"throw",t)}s(void 0)})},function(t){return K.apply(this,arguments)})},resultsList:{class:"X",destination:"form.K",maxResults:20,noResults:!1,element:function(t,e){e.results[0].value.hasOwnProperty("shortcut")&&t.insertAdjacentHTML("beforeend",'<label class="fa"><span>↑ / ↓ 切换</span><span>Tab / 空格 选中</span></label>')}},resultItem:{element:function(t,e){e.value.hasOwnProperty("shortcut")?t.innerHTML=N.itemContent(e.value):t.innerHTML=e.value}}}),G=document.querySelector("div.R"),B=document.querySelector("button.T"),F=function(){return r(function t(e){var r=this;n(this,t),this.ctx=e,this.searchBar=document.querySelector("input.Q"),this.wrapper=document.querySelector("div.L"),this.clickDelegate=this.clickDelegate.bind(this),this.dismiss=this.dismiss.bind(this),this.wrapper.addEventListener("click",this.clickDelegate,{once:!0}),this.ctx.input.addEventListener("selection",function(t){var e=t.detail.selection.value;N.currentEngine=e,N.switchIcon(e.icon);var n=r.searchBar.value;n.startsWith("#")||!n.trim()?(r.searchBar.value="",Y.changed()):U.start(),r.searchBar.focus()}),this.ctx.input.addEventListener("close",function(){return r.dismiss()}),this.ctx.input.addEventListener("keydown",function(t){" "!==t.key&&"Tab"!==t.key||(t.preventDefault(),r.ctx.select(r.ctx.cursor))})},[{key:"clickDelegate",value:function(){this.ctx.input.focus(),this.ctx.start("#")}},{key:"dismiss",value:function(){var t=this;setTimeout(function(){t.wrapper.addEventListener("click",t.clickDelegate,{once:!0})},200)}}])}(),W=function(){return r(function t(e){var r=this;n(this,t),this.ctx=e,this.changed=this.changed.bind(this),this.ctx.input.addEventListener("response",function(t){var e=r.ctx.list.classList,n=t.detail[0];r.isEngineList(n)?(e.add("Y"),e.remove("Z"),r.ctx.resultsList.maxResults=6,r.ctx.resultItem.class="aa",r.ctx.resultItem.selected="ha"):(e.add("Z"),e.remove("Y"),r.ctx.resultsList.maxResults=20,r.ctx.resultItem.class="ga",r.ctx.resultItem.selected="ia")}),this.ctx.input.addEventListener("navigate",function(t){var e=t.detail.selection.value;r.isEngineList(e)||(r.ctx.input.value=e)}),this.ctx.input.addEventListener("selection",function(t){var e=t.detail.selection.value;r.isEngineList(e)?(N.currentEngine=e,N.switchIcon(e.icon),r.ctx.input.value="",r.changed(),r.ctx.input.focus()):setTimeout(function(){r.ctx.input.value.trim()!=e&&(r.ctx.input.value=e,r.ctx.start())},50)}),this.ctx.input.addEventListener("keydown",function(t){var e=r.ctx.cursor,n=r.ctx.input.value;if(n&&!n.startsWith("#"))if("Enter"===t.key){t.preventDefault();var i=-1===e?n:r.ctx.list.children[e].innerText;N.dash(i),r.ctx.close()}else" "!==t.key&&"Tab"!==t.key||("Tab"===t.key&&t.preventDefault(),r.ctx.isOpen&&e>-1&&r.ctx.select(e));else r.ctx.isOpen&&n.startsWith("#")&&("Enter"!==t.key&&" "!==t.key&&"Tab"!==t.key||(t.preventDefault(),r.ctx.select(-1===e?0:e)))}),this.ctx.input.addEventListener("input",function(){!r.ctx.input.composing&&r.changed()}),this.ctx.input.addEventListener("compositionend",function(){return r.changed()})},[{key:"isEngineList",value:function(t){return"object"===p(t)&&(null==t?void 0:t.hasOwnProperty("shortcut"))}},{key:"changed",value:function(t){var e=this.ctx.input.value;t||e?(t||G.classList.add("S"),B.classList.add("U")):(G.classList.remove("S"),B.classList.remove("U"))}}])}();new F(R);var z,K,Y=new W(U);G.addEventListener("click",function(){U.input.value="",U.input.focus(),Y.changed()}),B.addEventListener("click",function(t){t.preventDefault();var e=U.input.value;e?N.dash(e):U.input.focus()})}();
